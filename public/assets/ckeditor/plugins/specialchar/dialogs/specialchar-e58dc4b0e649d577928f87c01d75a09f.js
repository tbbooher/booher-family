/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.dialog.add("specialchar",function(e){var t,a,n=e.lang.specialChar,i=function(a){var n,i;if(n=a.data?a.data.getTarget():new CKEDITOR.dom.element(a),"a"==n.getName()&&(i=n.getChild(0).getHtml())){n.removeClass("cke_light_background"),t.hide();var o=e.document.createElement("span");o.setHtml(i),e.insertText(o.getText())}},o=CKEDITOR.tools.addFunction(i),r=function(e,n){var i;if(n=n||e.data.getTarget(),"span"==n.getName()&&(n=n.getParent()),"a"==n.getName()&&(i=n.getChild(0).getHtml())){a&&l(null,a);var o=t.getContentElement("info","htmlPreview").getElement();t.getContentElement("info","charPreview").getElement().setHtml(i),o.setHtml(CKEDITOR.tools.htmlEncode(i)),n.getParent().addClass("cke_light_background"),a=n}},l=function(e,n){n=n||e.data.getTarget(),"span"==n.getName()&&(n=n.getParent()),"a"==n.getName()&&(t.getContentElement("info","charPreview").getElement().setHtml("&nbsp;"),t.getContentElement("info","htmlPreview").getElement().setHtml("&nbsp;"),n.getParent().removeClass("cke_light_background"),a=void 0)},s=CKEDITOR.tools.addFunction(function(t){t=new CKEDITOR.dom.event(t);var a,n,o=t.getTarget(),s=t.getKeystroke(),d="rtl"==e.lang.dir;switch(s){case 38:(a=o.getParent().getParent().getPrevious())&&(n=a.getChild([o.getParent().getIndex(),0]),n.focus(),l(null,o),r(null,n)),t.preventDefault();break;case 40:(a=o.getParent().getParent().getNext())&&(n=a.getChild([o.getParent().getIndex(),0]),n&&1==n.type&&(n.focus(),l(null,o),r(null,n))),t.preventDefault();break;case 32:i({data:t}),t.preventDefault();break;case d?37:39:case 9:(a=o.getParent().getNext())?(n=a.getChild(0),1==n.type?(n.focus(),l(null,o),r(null,n),t.preventDefault(!0)):l(null,o)):(a=o.getParent().getParent().getNext())&&(n=a.getChild([0,0]),n&&1==n.type?(n.focus(),l(null,o),r(null,n),t.preventDefault(!0)):l(null,o));break;case d?39:37:case CKEDITOR.SHIFT+9:(a=o.getParent().getPrevious())?(n=a.getChild(0),n.focus(),l(null,o),r(null,n),t.preventDefault(!0)):(a=o.getParent().getParent().getPrevious())?(n=a.getLast().getChild(0),n.focus(),l(null,o),r(null,n),t.preventDefault(!0)):l(null,o);break;default:return}});return{title:n.title,minWidth:430,minHeight:280,buttons:[CKEDITOR.dialog.cancelButton],charColumns:17,onLoad:function(){for(var t,a,i=this.definition.charColumns,r=(e.config.extraSpecialChars,e.config.specialChars),l=CKEDITOR.tools.getNextId()+"_specialchar_table_label",d=['<table role="listbox" aria-labelledby="'+l+'"'+' style="width: 320px; height: 100%; border-collapse: separate;"'+' align="center" cellspacing="2" cellpadding="2" border="0">'],c=0,u=r.length;u>c;){d.push("<tr>");for(var p=0;i>p;p++,c++){if(t=r[c]){if(a="",t instanceof Array)a=t[1],t=t[0];else{var m=t.replace("&","").replace(";","").replace("#","");a=n[m]||t}var h="cke_specialchar_label_"+c+"_"+CKEDITOR.tools.getNextNumber();d.push('<td class="cke_dark_background" style="cursor: default" role="presentation"><a href="javascript: void(0);" role="option" aria-posinset="'+(c+1)+'"',' aria-setsize="'+u+'"',' aria-labelledby="'+h+'"',' style="cursor: inherit; display: block; height: 1.25em; margin-top: 0.25em; text-align: center;" title="',CKEDITOR.tools.htmlEncode(a),'" onkeydown="CKEDITOR.tools.callFunction( '+s+', event, this )"'+' onclick="CKEDITOR.tools.callFunction('+o+', this); return false;"'+' tabindex="-1">'+'<span style="margin: 0 auto;cursor: inherit">'+t+"</span>"+'<span class="cke_voice_label" id="'+h+'">'+a+"</span></a>")}else d.push('<td class="cke_dark_background">&nbsp;');d.push("</td>")}d.push("</tr>")}d.push("</tbody></table>",'<span id="'+l+'" class="cke_voice_label">'+n.options+"</span>"),this.getContentElement("info","charContainer").getElement().setHtml(d.join(""))},contents:[{id:"info",label:e.lang.common.generalTab,title:e.lang.common.generalTab,padding:0,align:"top",elements:[{type:"hbox",align:"top",widths:["320px","90px"],children:[{type:"html",id:"charContainer",html:"",onMouseover:r,onMouseout:l,focus:function(){var e=this.getElement().getElementsByTag("a").getItem(0);setTimeout(function(){e.focus(),r(null,e)},0)},onShow:function(){var e=this.getElement().getChild([0,0,0,0,0]);setTimeout(function(){e.focus(),r(null,e)},0)},onLoad:function(e){t=e.sender}},{type:"hbox",align:"top",widths:["100%"],children:[{type:"vbox",align:"top",children:[{type:"html",html:"<div></div>"},{type:"html",id:"charPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:28px;height:40px;width:70px;padding-top:9px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"<div>&nbsp;</div>"},{type:"html",id:"htmlPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:14px;height:20px;width:70px;padding-top:2px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"<div>&nbsp;</div>"}]}]}]}]}]}});